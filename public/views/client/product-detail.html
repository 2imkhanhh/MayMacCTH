<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi tiết sản phẩm - May Mặc CTH</title>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../assets/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/product-detail.css">
</head>

<body>
    <!-- Top Header -->
    <div class="top-header bg-white border-bottom">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <div class="dropdown me-4">
                        <button class="btn btn-sm p-0 text-muted d-flex align-items-center" type="button"
                            aria-expanded="false">

                            <img src="../../assets/images/vietnam-flag.png" id="currentFlag"
                                style="width: 20px; height: 20px; object-fit: cover; border-radius: 3px;">
                            <span id="currentLang" class="ms-1">VN</span>
                        </button>

                        <!-- <ul class="dropdown-menu" aria-labelledby="languageDropdown" style="min-width: 120px;">
                            <li>
                                <a class="dropdown-item d-flex align-items-center choose-lang" data-lang="VN"
                                    data-flag="asset/images/vietnam-flag.png" href="#">
                                    <img src="asset/images/vietnam-flag.png"
                                        style="width: 22px; height: 22px; object-fit: cover; border-radius: 3px;">
                                    <span class="ms-2">VN</span>
                                </a>
                            </li>

                            <li>
                                <a class="dropdown-item d-flex align-items-center choose-lang" data-lang="EN"
                                    data-flag="asset/images/us-flag.png" href="#">
                                    <img src="asset/images/us-flag.png"
                                        style="width: 22px; height: 22px; object-fit: cover; border-radius: 3px;">
                                    <span class="ms-2">EN</span>
                                </a>
                            </li>
                        </ul> -->
                    </div>
                    <span class="text-muted me-3"></span>
                    <!-- <a href="tel:+0783157988" class="text-muted me-4">
                        <i class="bx bx-phone-call me-1"></i> 0783 157 988
                    </a> -->
                    <span class="text-muted me-4">
                        <i class="bx bx-phone-call me-1"></i> 0783 157 988
                    </span>
                </div>
                <!-- <a href="#" class="text-muted">
                    <i class="bx bx-git-compare me-1"></i> So sánh
                </a> -->
                <span class="text-muted">
                    <i class="bx bx-git-compare me-1"></i> So sánh
                </span>
            </div>
        </div>
    </div>

    <!-- Search Bar - CẬP NHẬT Ô TÌM KIẾM MỚI -->
    <div class="search-bar bg-white py-2">
        <div class="container">
            <div class="d-flex align-items-center justify-content-between">

                <a href="../../views/client/index.html"> <img src="../../assets/images/logo.png" alt="Logo" height="60"
                        class="me-32"></a>
                <div class="d-flex align-items-center">
                    <select class="form-select category-select" id="categorySelect">
                        <option value="">Tất cả</option>
                        <option value="uniform-shirts">Áo đồng phục</option>
                        <option value="uniform-pants">Quần đồng phục</option>
                    </select>

                    <div class="search-container">
                        <input type="text" class="form-control search-input" placeholder="Tìm kiếm sản phẩm..."
                            aria-label="Search">
                        <button class="search-button" type="button">
                            <i class='bx bx-search'></i>
                        </button>
                    </div>
                </div>

                <a href="tel:+0783157988" class="btn btn-outline-primary px-4">
                    <i class="bx bx-phone-call me-1"></i> 0783 157 988
                </a>
            </div>
        </div>
    </div>

    <!-- Menu -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto align-items-center">
                    <!-- Custom dropdown danh mục -->
                    <li class="nav-item dropdown-custom me-4">
                        <a href="#" class="nav-link text-warning d-flex align-items-center">
                            <i class="bx bx-menu me-2"></i> TẤT CẢ DANH MỤC
                        </a>
                        <ul class="dropdown-menu-custom">
                            <li><a href="#">Áo đồng phục</a></li>
                            <li><a href="#">Áo thể thao</a></li>
                            <li><a href="#">Áo + Logo áo</a></li>
                            <li><a href="#">BST + Logo áo</a></li>
                            <li><a href="#">Đồng phục công giáo</a></li>
                            <li><a href="#">Đồng phục công sở</a></li>
                            <li><a href="#">Đồng phục học tập</a></li>
                            <li><a href="#">Đồng phục mùa non</a></li>
                        </ul>
                    </li>

                    <!-- Các mục menu khác -->
                    <li class="nav-item"><a class="nav-link" href="../../views/client/index.html">Trang chủ</a></li>
                    <li class="nav-item"><a class="nav-link" href="../../views/client/about-us.html">Về chúng tôi</a>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="../../views/client/products.html">Sản phẩm</a></li>
                    <li class="nav-item"><a class="nav-link" href="../../views/client/guide.html">Hướng dẫn</a></li>
                    <li class="nav-item"><a class="nav-link" href="../../views/client/news.html">Tin tức</a></li>
                    <li class="nav-item"><a class="nav-link" href="../../views/client/contact.html">Liên hệ</a></li>
                </ul>

                <!-- Icon bên phải -->
                <ul class="navbar-nav ms-3">
                    <li class="nav-item">
                        <a class="nav-link" href="../../views/client/cart.html">
                            <i class="bx bx-cart"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content: Product Detail Section -->
    <section class="product-detail">
        <div class="title-section">
            <div class="container d-flex justify-content-between align-items-center flex-wrap">
                <div class="page-title" id="categoryTitle">ĐANG TẢI...</div>
                <div class="breadcrumb-nav" id="breadcrumb">
                    Trang chủ > <a href="products.html">Sản phẩm</a> > <span id="productNameBreadcrumb">...</span>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row align-items-start">
                <!-- Ảnh sản phẩm -->
                <div class="col-12 col-md-6 mb-4 mb-md-0">
                    <div class="product-image">
                        <img src="" alt="Đang tải..." id="main-product-image" class="w-100"
                            style="background:#f5f5f5; min-height:400px; object-fit:contain;">

                        <div class="thumbnail-images mt-3 d-flex gap-2 flex-wrap" id="thumbnailContainer">
                            <!-- Thumbnail sẽ được load bằng JS -->
                        </div>
                    </div>

                    <!-- Accordion chi tiết -->
                    <div class="accordion product-info-accordion mt-4" id="productDetailsAccordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapseDetails">
                                    Chi tiết sản phẩm
                                </button>
                            </h2>
                            <div id="collapseDetails" class="accordion-collapse collapse">
                                <div class="accordion-body" id="productDescription">
                                    Đang tải mô tả...
                                </div>
                            </div>
                        </div>
                        <!-- FAQ giữ nguyên như cũ -->
                    </div>
                </div>

                <!-- Thông tin sản phẩm -->
                <div class="col-12 col-md-6">
                    <div class="product-info">
                        <h1 class="product-title mb-0" id="productName">Đang tải sản phẩm...</h1>

                        <div class="price-range mb-4">
                            <span class="price h3 fw-bold text-danger" id="productPrice">0đ</span>
                        </div>

                        <div class="product-meta mb-4 text-muted small">
                            <div><strong>Mã sản phẩm:</strong> <span id="productSku">SP00</span></div>
                            <div><strong>Danh mục:</strong> <span id="productCategory">-</span></div>
                        </div>

                        <!-- Màu sắc (nếu có) -->
                        <div class="color-options mb-4" id="colorOptions" style="display: none;">
                            <h6 class="fw-bold mb-2">Màu sắc</h6>
                            <div class="color-swatches d-flex gap-2" id="colorSwatches"></div>
                        </div>

                        <!-- Kích thước -->
                        <div class="size-options mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="fw-bold mb-0">Kích thước</h6>
                                <a href="#" class="size-guide text-primary small">Hướng dẫn chọn size</a>
                            </div>
                            <div class="size-buttons d-flex gap-2" id="sizeButtons">
                                <button class="btn btn-outline-secondary btn-size active" data-size="M">M</button>
                                <!-- JS sẽ fill nếu có size từ DB -->
                            </div>
                        </div>

                        <!-- Số lượng + nút -->
                        <div class="quantity mb-4">
                            <h6 class="fw-bold mb-2">Số lượng</h6>
                            <div class="input-group w-50">
                                <button class="btn btn-outline-secondary" type="button" id="decrease">-</button>
                                <input type="text" class="form-control text-center fw-bold" value="1" readonly
                                    id="quantityInput">
                                <button class="btn btn-outline-secondary" type="button" id="increase">+</button>
                            </div>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn-add-cart" id="addToCartBtn">
                                Thêm vào giỏ hàng
                            </button>
                            <button class="btn btn-buy" id="orderBtn">
                                Mua ngay
                            </button>
                        </div>

                        <!-- <div class="product-description-wrapper mt-4 pt-3">
                            <div class="section-title-container">
                                <h2 class="section-title">Mô tả sản phẩm</h2>
                            </div>
                            <div class="product-description-content mt-3" id="shortDescription">
                                Đang tải...
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- size table -->
    <div class="modal fade" id="sizeGuideModal" tabindex="-1" aria-labelledby="sizeGuideLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="sizeGuideLabel">HƯỚNG DẪN CHỌN SIZE</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="text-center">
                    <img src="../../assets/images/size-table.png" alt="Bảng size" class="img-fluid rounded shadow">
                </div>
            </div>
        </div>
    </div>

    <div class="container my-4">
        <hr class="section-divider">
    </div>

    <!-- review -->
    <section class="product-reviews-section">
        <div class="container">
            <div class="reviews-header">
                <h2 class="reviews-main-title">Đánh giá sản phẩm</h2>
                <div class="overall-rating">
                    <span class="rating-score">4.0</span>
                    <div class="rating-stars text-warning">
                        <i class='bx bxs-star'></i>
                        <i class='bx bxs-star'></i>
                        <i class='bx bxs-star'></i>
                        <i class='bx bxs-star'></i>
                        <i class='bx bx-star'></i>
                    </div>
                    <span class="review-count-text">Dựa trên 50 khách hàng</span>
                </div>
                <div class="my-4">
                    <button class="btn btn-review px-4" data-bs-toggle="collapse" data-bs-target="#writeReviewCollapse">
                        <i class='bx bxs-edit-alt'></i> Viết đánh giá
                    </button>
                </div>
            </div>
            <div class="collapse mt-4" id="writeReviewCollapse">
                <div class="p-4 border rounded bg-light">
                    <h5 class="fw-bold mb-3">Viết đánh giá của bạn</h5>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Số điện thoại</label>
                        <input type="text" class="form-control" id="reviewPhone" placeholder="Nhập số điện thoại">
                    </div>
                    <!-- Tên khách -->
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Họ tên</label>
                        <input type="text" class="form-control" id="reviewName" placeholder="Nhập tên">
                    </div>

                    <!-- Số sao -->
                    <div class="mb-3">
                        <label class="form-label fw-semibold d-block">Xếp hạng</label>
                        <div class="rating-stars-input" id="ratingStars">
                            <i class='bx bx-star' data-value="1"></i>
                            <i class='bx bx-star' data-value="2"></i>
                            <i class='bx bx-star' data-value="3"></i>
                            <i class='bx bx-star' data-value="4"></i>
                            <i class='bx bx-star' data-value="5"></i>
                        </div>
                    </div>

                    <!-- Size -->
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Kích thước bạn đã mua</label>
                        <select class="form-select" id="reviewSize">
                            <option value="">Chọn size</option>
                            <option value="S">S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                        </select>
                    </div>

                    <!-- Màu -->
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Màu sắc</label>
                        <input type="text" class="form-control" id="reviewColor" placeholder="VD: Đen, Trắng, Đỏ,...">
                    </div>

                    <!-- Nội dung -->
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Nội dung đánh giá</label>
                        <textarea class="form-control" rows="4" id="reviewContent"
                            placeholder="Chia sẻ trải nghiệm của bạn..."></textarea>
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-semibold">Chọn tag phù hợp với trải nghiệm của bạn <small
                                class="text-muted">(có thể chọn nhiều)</small></label>
                        <div class="review-tag-selection d-flex flex-wrap gap-2" id="reviewTagContainer">
                            <div class="text-center py-5 text-muted w-100">
                                <i class='bx bx-loader-alt bx-spin'></i> Đang tải tag...
                            </div>
                        </div>
                    </div>

                    <!-- Upload ảnh -->
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Thêm hình ảnh (tối đa 5)</label>
                        <input type="file" class="form-control" id="reviewImages" accept="image/*" multiple>
                        <div id="previewImages" class="d-flex gap-2 mt-2 flex-wrap"></div>
                    </div>

                    <!-- Nút gửi + nút hủy -->
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary px-4" id="submitReview">Gửi đánh giá</button>
                        <button class="btn btn-outline-secondary" data-bs-toggle="collapse"
                            data-bs-target="#writeReviewCollapse">Hủy</button>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12 col-lg-4">
                    <div class="review-filters">
                        <h6 class="filter-title">Lọc đánh giá</h6>
                        <div class="input-group search-reviews mb-4">
                            <span class="input-group-text">
                                <i class='bx bx-search'></i>
                            </span>
                            <input type="text" class="form-control" placeholder="Tìm kiếm đánh giá">
                        </div>

                        <h6 class="filter-title">Phân loại xếp hạng</h6>
                        <ul class="filter-list star-filter-list">
                            <li>
                                <button class="btn btn-filter-star active">
                                    5 <i class='bx bxs-star'></i>
                                </button>
                            </li>
                            <li>
                                <button class="btn btn-filter-star">
                                    4 <i class='bx bxs-star'></i>
                                </button>
                            </li>
                            <li>
                                <button class="btn btn-filter-star">
                                    3 <i class='bx bxs-star'></i>
                                </button>
                            </li>
                            <li>
                                <button class="btn btn-filter-star">
                                    2 <i class='bx bxs-star'></i>
                                </button>
                            </li>
                            <li>
                                <button class="btn btn-filter-star">
                                    1 <i class='bx bxs-star'></i>
                                </button>
                            </li>
                        </ul>

                        <h6 class="filter-title mt-4">Lọc phản hồi</h6>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="checkHasFeedback">
                            <label class="form-check-label" for="checkHasFeedback">
                                Đã phản hồi
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="checkHasImage">
                            <label class="form-check-label" for="checkHasImage">
                                Có hình ảnh
                            </label>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-lg-8 mt-4 mt-lg-0">
                    <div class="review-list">
                        <div class="review-item">
                            <div class="review-author">
                                <strong>Trần Anh Tùng</strong>
                                <span class="review-date">20/07/2025</span>
                            </div>
                            <div class="review-rating text-warning">
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                            </div>
                            <div class="review-product-details">
                                <span>Kích thước: L</span>
                                <span>Màu sắc: Rêu</span>
                                <span>Phù hợp với cơ thể: Đúng kích thước</span>
                            </div>
                            <p class="review-text">Sp đẹp.</p>
                            <div class="review-tags">
                                <span class="tag">Sản phẩm đẹp</span>
                                <span class="tag">Giá tốt</span>
                                <span class="tag">Đóng gói đẹp</span>
                                <span class="tag">Giao hàng nhanh</span>
                                <span class="tag">Chăm sóc khách hàng tận tình</span>
                            </div>
                        </div>

                        <div class="review-item">
                            <div class="review-author">
                                <strong>phamngocthang381@gmail.com</strong>
                                <span class="review-date">12/12/2024</span>
                            </div>
                            <div class="review-rating text-warning">
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                            </div>
                            <div class="review-product-details">
                                <span>Kích thước: L</span>
                                <span>Màu sắc: Xanh Colony</span>
                                <span>Phù hợp với cơ thể: Đúng kích thước</span>
                            </div>
                            <p class="review-text">mọi thứ ok và chăm sóc chu đáo</p>
                            <div class="review-images">
                                <img src="../../assets/images/product1.png" alt="Ảnh review 1">
                                <img src="../../assets/images/product2.png" alt="Ảnh review 2">
                                <img src="../../assets/images/product3.png" alt="Ảnh review 3">
                                <img src="../../assets/images/product4.png" alt="Ảnh review 4">
                                <img src="../../assets/images/product5.png" alt="Ảnh review 5">
                            </div>
                            <div class="review-tags">
                                <span class="tag">Giao hàng nhanh</span>
                            </div>
                        </div>

                        <div class="review-item">
                            <div class="review-author">
                                <strong>Trần Anh Tùng</strong>
                                <span class="review-date">20/07/2025</span>
                            </div>
                            <div class="review-rating text-warning">
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                            </div>
                            <div class="review-product-details">
                                <span>Kích thước: L</span>
                                <span>Màu sắc: Rêu</span>
                                <span>Phù hợp với cơ thể: Đúng kích thước</span>
                            </div>
                            <p class="review-text">Sp đẹp.</p>
                            <div class="review-tags">
                                <span class="tag">Sản phẩm đẹp</span>
                                <span class="tag">Giá tốt</span>
                                <span class="tag">Đóng gói đẹp</span>
                                <span class="tag">Giao hàng nhanh</span>
                                <span class="tag">Chăm sóc khách hàng tận tình</span>
                            </div>
                        </div>

                        <div class="review-item">
                            <div class="review-author">
                                <strong>Trần Anh Tùng</strong>
                                <span class="review-date">20/07/2025</span>
                            </div>
                            <div class="review-rating text-warning">
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                            </div>
                            <div class="review-product-details">
                                <span>Kích thước: L</span>
                                <span>Màu sắc: Rêu</span>
                                <span>Phù hợp với cơ thể: Đúng kích thước</span>
                            </div>
                            <p class="review-text">Sp đẹp.</p>
                            <div class="review-tags">
                                <span class="tag">Sản phẩm đẹp</span>
                                <span class="tag">Giá tốt</span>
                                <span class="tag">Đóng gói đẹp</span>
                                <span class="tag">Giao hàng nhanh</span>
                                <span class="tag">Chăm sóc khách hàng tận tình</span>
                            </div>
                        </div>

                        <div class="review-item">
                            <div class="review-author">
                                <strong>user381@gmail.com</strong>
                                <span class="review-date">12/12/2024</span>
                            </div>
                            <div class="review-rating text-warning">
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                                <i class='bx bxs-star'></i>
                            </div>
                            <div class="review-product-details">
                                <span>Kích thước: L</span>
                                <span>Màu sắc: Xanh Colony</span>
                                <span>Phù hợp với cơ thể: Đúng kích thước</span>
                            </div>
                            <p class="review-text">mọi thứ ok và chăm sóc chu đáo</p>
                            <div class="review-images">
                                <img src="../../assets/images/product1.png" alt="Ảnh review 1">
                                <img src="../../assets/images/product2.png" alt="Ảnh review 2">
                                <img src="../../assets/images/product3.png" alt="Ảnh review 3">
                                <img src="../../assets/images/product4.png" alt="Ảnh review 4">
                                <img src="../../assets/images/product5.png" alt="Ảnh review 5">
                            </div>
                            <div class="review-tags">
                                <span class="tag">Giao hàng nhanh</span>
                            </div>
                        </div>
                    </div>
                    <!-- Pagination -->
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center" id="reviewPagination">
                            <li class="page-item">
                                <a class="page-link" href="#" aria-label="Previous" id="prevPage">
                                    <i class='bx bx-chevron-left'></i>
                                </a>
                            </li>
                            <li class="page-item"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                            <li class="page-item">
                                <a class="page-link" href="#" aria-label="Next" id="nextPage">
                                    <i class='bx bx-chevron-right'></i>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </section>

    <!-- <div id="addToCartToast" class="toast-notification">
        <div class="toast-icon">
            <i class="bx bx-check-circle"></i>
        </div>
        <div class="toast-content">
            <div class="toast-title">Thêm vào giỏ hàng thành công!</div>
            <div class="toast-message" id="toastProductName">Sản phẩm XYZ</div>
        </div>
        <button class="toast-close">&times;</button>
    </div> -->

    <!-- Footer -->
    <footer class="footer bg-primary text-white py-5">
        <div class="container">
            <div class="row gy-4">
                <!-- Logo + Giới thiệu -->
                <div class="col-12 col-md-4 col-lg-3">
                    <a href="../../views/client/index.html"><img src="../../assets/images/logo2.png" alt="Logo"
                            class="footer-logo mb-3"></a>
                    <p class="footer-slogan">MAY MẶC CTH lắng nghe bạn!</p>
                    <p class="footer-desc">
                        Chúng tôi luôn trân trọng mọi ý kiến đóng góp của khách hàng,
                        không ngừng cải thiện để mang đến sản phẩm và dịch vụ tốt nhất.
                    </p>
                    <button class="btn btn-warning footer-btn">ĐÓNG GÓP Ý KIẾN →</button>
                    <p class="footer-tax mt-3"><strong>MÃ SỐ THUẾ:</strong> 0202167805</p>
                </div>

                <!-- Về chúng tôi -->
                <div class="col-6 col-md-4 col-lg-2">
                    <p class="footer-title">VỀ CHÚNG TÔI</p>
                    <ul class="footer-links">
                        <li><a href="#">Giới thiệu MAY MẶC CTH</a></li>
                        <li><a href="#">Hướng dẫn mua hàng</a></li>
                        <li><a href="#">Hướng dẫn chọn size</a></li>
                        <li><a href="#">Chính sách đổi trả</a></li>
                        <li><a href="#">Chính sách giao hàng</a></li>
                        <li><a href="#">FAQ</a></li>
                    </ul>
                </div>

                <!-- Sản phẩm -->
                <div class="col-6 col-md-4 col-lg-2">
                    <p class="footer-title">SẢN PHẨM</p>
                    <ul class="footer-links">
                        <li><a href="#">Áo đồng phục</a></li>
                        <li><a href="#">Áo thể thao</a></li>
                        <li><a href="#">BST + Logo áo</a></li>
                        <li><a href="#">Đồng phục công giáo</a></li>
                        <li><a href="#">Đồng phục công sở</a></li>
                        <li><a href="#">Đồng phục học tập</a></li>
                    </ul>
                </div>

                <!-- Tin tức -->
                <div class="col-6 col-md-6 col-lg-2">
                    <p class="footer-title">TIN TỨC</p>
                    <ul class="footer-links">
                        <li><a href="#">Xu hướng thời trang</a></li>
                        <li><a href="#">Sức khỏe & Đời sống</a></li>
                        <li><a href="#">Bí mật Gạo House</a></li>
                        <li><a href="#">Mẹo hay MAY MẶC</a></li>
                        <li><a href="#">Tin tức</a></li>
                    </ul>
                </div>

                <!-- Thông tin liên hệ + Nút liên hệ -->
                <div class="col-12 col-md-12 col-lg-3">
                    <p class="footer-title mb-3">THÔNG TIN LIÊN HỆ</p>

                    <!-- Dùng flex để icon và chữ luôn thẳng hàng -->
                    <div class="d-flex align-items-start mb-2">
                        <i class='bx bx-map text-warning me-3' style="font-size: 1.4rem; min-width: 26px;"></i>
                        <span id="footerAddress" class="text-white">Đang tải địa chỉ...</span>
                    </div>

                    <div class="d-flex align-items-start mb-2">
                        <i class='bx bx-globe text-success me-3' style="font-size: 1.4rem; min-width: 26px;"></i>
                        <span id="footerWebsite" class="text-white">Đang tải website...</span>
                    </div>

                    <div class="d-flex align-items-start mb-4">
                        <i class='bx bx-phone text-danger me-3' style="font-size: 1.4rem; min-width: 26px;"></i>
                        <span id="footerPhone" class="text-white">Đang tải số điện thoại...</span>
                    </div>

                    <!-- Nút liên hệ giữ nguyên -->
                    <div class="footer-contact-btns mt-3">
                        <a href="https://zalo.me/078315798" class="contact-card">
                            <div class="contact-icon"><img src="../../assets/images/zalo.png" alt="Zalo"></div>
                            <div class="contact-text"><span class="contact-label">TƯ VẤN QUA</span><span
                                    class="contact-value">ZALO</span></div>
                        </a>
                        <a href="tel:+078315798" class="contact-card">
                            <div class="contact-icon"><img src="../../assets/images/hotline.png" alt="Hotline"></div>
                            <div class="contact-text"><span class="contact-label">HOTLINE</span><span
                                    class="contact-value">0783 157 98</span></div>
                        </a>
                        <a href="tel:+078315798" class="contact-card">
                            <div class="contact-icon"><img src="../../assets/images/hotline.png" alt="Tại cửa hàng">
                            </div>
                            <div class="contact-text"><span class="contact-label">TẠI CỬA HÀNG</span><span
                                    class="contact-value">078315798</span></div>
                        </a>
                    </div>
                </div>
            </div>
            <hr class="footer-divider my-4">

            <!-- Thanh toán -->
            <div class="row">
                <div class="col text-center">
                    <p class="mb-2 footer-title">PHƯƠNG THỨC THANH TOÁN</p>
                    <div class="d-flex justify-content-center align-items-center gap-3">
                        <img src="../../assets/images/cash.png" height="30" alt="Cash">
                        <img src="../../assets/images/mastercard.png" height="30" alt="Mastercard">
                        <img src="../../assets/images/visa.png" height="30" alt="Visa">
                    </div>
                </div>
            </div>

            <!-- <p class="text-center mt-4 small mb-0">&copy; 2025 MAY MẶC CTH. All rights reserved.</p> -->
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../js/script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Phân trang
            const reviewItems = document.querySelectorAll('.review-item');
            const reviewPagination = document.getElementById('reviewPagination');
            const reviewList = document.querySelector('.review-list');
            const itemsPerPage = 3;
            let currentPage = 1;

            function showReviewPage(page, scroll = true) { // Thêm tham số scroll
                const totalPages = Math.ceil(reviewItems.length / itemsPerPage);
                if (page < 1) page = 1;
                if (page > totalPages) page = totalPages;

                reviewItems.forEach(item => item.style.display = 'none');
                for (let i = (page - 1) * itemsPerPage; i < page * itemsPerPage && i < reviewItems.length; i++) {
                    reviewItems[i].style.display = 'block';
                }

                reviewPagination.innerHTML = '';
                const maxPagesToShow = 5;
                let startPage = Math.max(1, page - Math.floor(maxPagesToShow / 2));
                let endPage = Math.min(totalPages, startPage + maxPagesToShow - 1);

                if (endPage - startPage < maxPagesToShow - 1) {
                    startPage = Math.max(1, endPage - maxPagesToShow + 1);
                }

                reviewPagination.innerHTML += `
                    <li class="page-item ${page === 1 ? 'disabled' : ''}">
                        <a class="page-link" href="#" aria-label="Previous" id="prevPage">
                            <i class='bx bx-chevron-left'></i> Trước
                        </a>
                    </li>
                `;

                for (let i = startPage; i <= endPage; i++) {
                    reviewPagination.innerHTML += `
                        <li class="page-item ${i === page ? 'active' : ''}">
                            <a class="page-link" href="#">${i}</a>
                        </li>
                    `;
                }

                reviewPagination.innerHTML += `
                    <li class="page-item ${page === totalPages ? 'disabled' : ''}">
                        <a class="page-link" href="#" aria-label="Next" id="nextPage">
                            Sau <i class='bx bx-chevron-right'></i>
                        </a>
                    </li>
                `;

                currentPage = page;

                // Chỉ cuộn khi người dùng tương tác với phân trang
                if (scroll && reviewList) {
                    reviewList.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }

            reviewPagination.addEventListener('click', function (e) {
                e.preventDefault();
                if (e.target.tagName === 'A' && e.target.closest('#reviewPagination')) {
                    const link = e.target;
                    if (link.id === 'prevPage') {
                        showReviewPage(currentPage - 1);
                    } else if (link.id === 'nextPage') {
                        showReviewPage(currentPage + 1);
                    } else {
                        const page = parseInt(link.textContent);
                        currentPage = page;
                        showReviewPage(page);
                    }
                }
            });

            // Không cuộn khi trang tải
            showReviewPage(1, false);
        })
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');
            const contentContainer = document.querySelector('.product-detail > .container');

            contentContainer.innerHTML = '<div class="text-center py-5"><h1>Đang tải sản phẩm...</h1></div>';

            if (!productId || isNaN(productId)) {
                contentContainer.innerHTML = '<div class="text-center py-5"><h1 class="text-danger">ID không hợp lệ!</h1></div>';
                return;
            }

            try {
                const res = await fetch(`../../../api/product/get_product.php`);
                if (!res.ok) throw new Error('Lỗi server');
                const result = await res.json();
                if (!result.success || !result.data?.length) throw new Error('Không có sản phẩm');

                const p = result.data.find(item => item.product_id == productId);
                if (!p) throw new Error('Sản phẩm không tồn tại');

                // Cập nhật tiêu đề + breadcrumb
                const categoryTitleEl = document.getElementById('categoryTitle');
                const breadcrumbEl = document.getElementById('productNameBreadcrumb');
                if (categoryTitleEl) categoryTitleEl.textContent = p.category_name || 'SẢN PHẨM';
                if (breadcrumbEl) breadcrumbEl.textContent = p.name;

                // Render nội dung + phần chính sách ĐẸP CHUẨN
                contentContainer.innerHTML = `
                    <div class="row align-items-start">
                        <!-- Ảnh sản phẩm -->
                        <div class="col-12 col-md-6 mb-4 mb-md-0">
                            <div class="product-image">
                                <img src="" alt="${p.name}" id="main-product-image" class="w-100"
                                    style="background:#f5f5f5; min-height:400px; object-fit:contain;">
                                <div class="thumbnail-images mt-3 d-flex gap-2 flex-wrap" id="thumbnailContainer"></div>
                            </div>

                            <div class="accordion product-info-accordion mt-4">
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                            data-bs-target="#collapseDetails">
                                            Chi tiết sản phẩm
                                        </button>
                                    </h2>
                                    <div id="collapseDetails" class="accordion-collapse collapse">
                                        <div class="accordion-body">
                                            ${p.description ? p.description.replace(/\n/g, '<br>') : 'Chưa có mô tả chi tiết.'}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Thông tin sản phẩm -->
                        <div class="col-12 col-md-6">
                            <div class="product-info">
                                <h1 class="product-title mb-0">${p.name}</h1>
                                <div class="price-range mb-4">
                                    <span class="price h3 fw-bold text-danger">
                                        ${parseInt(p.price || 0).toLocaleString('vi-VN')}đ
                                    </span>
                                </div>
                                <div class="product-meta mb-4 text-muted small">
                                    <div><strong>Mã sản phẩm:</strong> SP${String(p.product_id).padStart(4, '0')}</div>
                                    <div><strong>Danh mục:</strong> ${p.category_name || 'Chưa xác định'}</div>
                                </div>

                                <!-- MÀU SẮC -->
                                ${p.colors && p.colors.length ? `
                                <div class="color-options mb-4">
                                    <h6 class="fw-bold mb-2">Màu sắc</h6>
                                    <div class="color-swatches d-flex gap-2 flex-wrap" id="colorSwatches"></div>
                                </div>` : ''}

                                <!-- KÍCH THƯỚC -->
                                <div class="size-options mb-4">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <h6 class="fw-bold mb-0">Kích thước</h6>
                                        <a href="#" class="size-guide text-primary small">Hướng dẫn chọn size</a>
                                    </div>
                                    <div class="size-buttons d-flex gap-2 flex-wrap" id="sizeButtons"></div>
                                </div>

                                <div class="quantity mb-4">
                                    <h6 class="fw-bold mb-2">Số lượng</h6>
                                    <div class="input-group w-50">
                                        <button class="btn btn-outline-secondary" type="button" id="decrease">-</button>
                                        <input type="text" class="form-control text-center fw-bold" value="1" readonly id="quantityInput">
                                        <button class="btn btn-outline-secondary" type="button" id="increase">+</button>
                                    </div>
                                </div>

                                <div class="action-buttons mb-5">
                                    <button class="btn btn-add-cart" id="addToCartBtn">Thêm vào giỏ hàng</button>
                                    <button class="btn btn-buy" id="orderBtn">Mua ngay</button>
                                </div>

                                <!-- Dịch vụ -->
                                <div class="product-description-wrapper mt-4 pt-3 border-bottom">
                                    <h2 class="section-title">Dịch vụ của chúng tôi</h2>
                                </div>
                                <!-- PHẦN CHÍNH SÁCH HỖ TRỢ - ĐẸP Y CHANG BẠN MUỐN -->
                                <div class="policy-wrapper mt-5">
                                    <div class="row g-4">
                                        <div class="col-12 col-md-6">
                                            <div class="policy-item">
                                                <div class="policy-icon-box text-box">
                                                    <span>FREE</span>
                                                    <span>SHIP</span>
                                                </div>
                                                <div class="policy-content">
                                                    <span class="policy-title">Free ship cho đơn trên 200k</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-12 col-md-6">
                                            <div class="policy-item">
                                                <div class="policy-icon-box">
                                                    <i class='bx bx-sync'></i>
                                                </div>
                                                <div class="policy-content">
                                                    <span class="policy-title">30 ngày đổi trả cho bất kì thứ gì</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-12 col-md-6">
                                            <div class="policy-item">
                                                <div class="policy-icon-box">
                                                    <i class='bx bx-phone-call'></i>
                                                </div>
                                                <div class="policy-content">
                                                    <span class="policy-title">Hotline hỗ trợ 0783159798</span>
                                                    <span class="policy-sub">hỗ trợ từ 8h30 - 22h</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-12 col-md-6">
                                            <div class="policy-item">
                                                <div class="policy-icon-box">
                                                    <i class='bx bx-map-pin'></i>
                                                </div>
                                                <div class="policy-content">
                                                    <span class="policy-title">Đến tận nơi nhận trả hàng</span>
                                                    <span class="policy-sub">hoàn tiền trong 24h</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // ==================== ẢNH ====================
                const mainImg = document.getElementById('main-product-image');
                const thumbContainer = document.getElementById('thumbnailContainer');
                thumbContainer.innerHTML = '';

                let allImages = [];
                if (p.images && Array.isArray(p.images)) {
                    allImages = p.images.map(i => typeof i === 'object' ? i.image : i).filter(Boolean);
                }
                if (!allImages.length && p.primary_image) allImages.push(p.primary_image);
                if (!allImages.length) allImages.push('no-image.jpg');

                allImages.forEach((img, i) => {
                    const src = `../../assets/images/upload/${img}`;
                    if (i === 0) mainImg.src = src;

                    const thumb = document.createElement('img');
                    thumb.src = src;
                    thumb.alt = p.name;
                    thumb.className = 'thumbnail';
                    thumb.style.cssText = 'width:80px;height:80px;object-fit:cover;cursor:pointer;border:2px solid #eee;border-radius:8px;';
                    if (i === 0) thumb.classList.add('active');
                    thumb.onclick = () => {
                        mainImg.src = src;
                        document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
                        thumb.classList.add('active');
                    };
                    thumbContainer.appendChild(thumb);
                });

                // ==================== MÀU + SIZE ====================
                if (p.colors && p.colors.length) {
                    const colorSwatches = document.getElementById('colorSwatches');
                    p.colors.forEach((color, idx) => {
                        const btn = document.createElement('button');
                        btn.type = 'button';
                        btn.className = 'btn border position-relative';
                        btn.style.backgroundColor = color.color_code || '#ccc';
                        btn.style.width = '44px';
                        btn.style.height = '44px';
                        btn.title = color.color_name;
                        if (idx === 0) btn.classList.add('active', 'border-primary');

                        const span = document.createElement('span');
                        span.className = 'position-absolute top-50 start-50 translate-middle text-white fw-bold';
                        span.style.fontSize = '10px';
                        span.textContent = color.color_name.substring(0, 3).toUpperCase();
                        btn.appendChild(span);

                        btn.onclick = () => {
                            colorSwatches.querySelectorAll('button').forEach(b => b.classList.remove('active', 'border-primary'));
                            btn.classList.add('active', 'border-primary');
                            updateSizes(color.sizes || []);
                        };
                        colorSwatches.appendChild(btn);
                    });
                    updateSizes(p.colors[0].sizes || []);
                } else {
                    document.getElementById('sizeButtons').innerHTML = '<span class="text-muted">Không có size</span>';
                }

                function updateSizes(sizes) {
                    const sizeButtons = document.getElementById('sizeButtons');
                    sizeButtons.innerHTML = '';
                    if (!sizes?.length) {
                        sizeButtons.innerHTML = '<span class="text-muted">Không có size</span>';
                        return;
                    }
                    sizes.forEach((size, idx) => {
                        const btn = document.createElement('button');
                        btn.type = 'button';
                        btn.className = 'btn btn-outline-secondary btn-size';
                        btn.textContent = size;
                        if (idx === 0) btn.classList.add('active');
                        btn.onclick = () => {
                            sizeButtons.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                            btn.classList.add('active');
                        };
                        sizeButtons.appendChild(btn);
                    });
                }

                // Nút chức năng
                document.getElementById('increase')?.addEventListener('click', () => {
                    const input = document.getElementById('quantityInput');
                    input.value = parseInt(input.value) + 1;
                });
                document.getElementById('decrease')?.addEventListener('click', () => {
                    const input = document.getElementById('quantityInput');
                    if (parseInt(input.value) > 1) input.value = parseInt(input.value) - 1;
                });
                document.getElementById('addToCartBtn')?.addEventListener('click', function () {
                    // Lấy thông tin đã chọn
                    const selectedColorBtn = document.querySelector('#colorSwatches .btn.active');
                    const selectedSizeBtn = document.querySelector('#sizeButtons .btn-size.active');
                    const quantity = parseInt(document.getElementById('quantityInput').value) || 1;

                    // Kiểm tra chọn màu và size (nếu có)
                    if (p.colors && p.colors.length && !selectedColorBtn) {
                        alert('Vui lòng chọn màu sắc!');
                        return;
                    }
                    if (!selectedSizeBtn) {
                        alert('Vui lòng chọn kích thước!');
                        return;
                    }

                    const colorName = selectedColorBtn ? selectedColorBtn.title : 'Không có màu';
                    const size = selectedSizeBtn ? selectedSizeBtn.dataset.size || selectedSizeBtn.textContent : 'Freesize';
                    const price = parseInt(p.price || 0);
                    const image = document.getElementById('main-product-image').src;

                    // Tạo object sản phẩm để thêm vào giỏ
                    const cartItem = {
                        id: p.product_id,
                        name: p.name,
                        price: price,
                        quantity: quantity,
                        color: colorName,
                        size: size,
                        image: image.includes('upload/') ? image.split('/').pop() : 'no-image.jpg', // lưu tên file ảnh
                        uniqueKey: `${p.product_id}-${colorName}-${size}` // key duy nhất để tránh trùng
                    };

                    // Lấy giỏ hàng hiện tại từ localStorage
                    let cart = JSON.parse(localStorage.getItem('cart') || '[]');

                    // Kiểm tra sản phẩm (cùng id + màu + size) đã có chưa
                    const existingIndex = cart.findIndex(item => item.uniqueKey === cartItem.uniqueKey);

                    if (existingIndex !== -1) {
                        // Nếu đã có → tăng số lượng
                        cart[existingIndex].quantity += quantity;
                        alert(`Đã cập nhật số lượng: ${p.name} (${colorName}, ${size})`);
                    } else {
                        // Nếu chưa có → thêm mới
                        cart.push(cartItem);
                        alert(`Đã thêm vào giỏ hàng: ${p.name}`);
                    }

                    // Lưu lại vào localStorage
                    localStorage.setItem('cart', JSON.stringify(cart));

                    // Optional: Cập nhật số lượng giỏ hàng trên header (nếu bạn có icon giỏ hàng)
                    updateCartCount();
                });
                document.getElementById('orderBtn')?.addEventListener('click', function () {
                    // Lấy thông tin đã chọn
                    const selectedColorBtn = document.querySelector('#colorSwatches .btn.active');
                    const selectedSizeBtn = document.querySelector('#sizeButtons .btn-size.active');
                    const quantity = parseInt(document.getElementById('quantityInput').value) || 1;

                    // Kiểm tra bắt buộc chọn màu & size
                    if (p.colors && p.colors.length && !selectedColorBtn) {
                        alert('Vui lòng chọn màu sắc!');
                        return;
                    }
                    if (!selectedSizeBtn) {
                        alert('Vui lòng chọn kích thước!');
                        return;
                    }

                    const colorName = selectedColorBtn ? selectedColorBtn.title : null;
                    const size = selectedSizeBtn ? selectedSizeBtn.textContent : 'Freesize';
                    const price = parseInt(p.price || 0);
                    const image = document.getElementById('main-product-image').src.split('/').pop();

                    // Tạo object sản phẩm
                    const buyNowItem = {
                        id: p.product_id,
                        name: p.name,
                        price: price,
                        quantity: quantity,
                        color: colorName,
                        size: size,
                        image: image || 'no-image.jpg',
                        uniqueKey: `${p.product_id}-${colorName || 'no-color'}-${size}`
                    };

                    // XÓA GIỎ HÀNG CŨ → CHỈ GIỮ RIÊNG SẢN PHẨM NÀY
                    localStorage.setItem('cart', JSON.stringify([buyNowItem]));

                    // CHUYỂN NGAY QUA TRANG ĐẶT HÀNG
                    window.location.href = '../client/order.html';
                });
                document.querySelector('.size-guide')?.addEventListener('click', e => {
                    e.preventDefault();
                    new bootstrap.Modal(document.getElementById('sizeGuideModal')).show();
                });

                document.title = `${p.name} - May Mặc CTH`;

            } catch (err) {
                console.error(err);
                contentContainer.innerHTML = `<div class="text-center py-5"><h1 class="text-danger">Lỗi tải sản phẩm</h1><p>${err.message}</p><button class="btn btn-primary" onclick="location.reload()">Tải lại</button></div>`;
            }

            async function loadReviewTags() {
                const container = document.getElementById('reviewTagContainer');
                if (!container) return;

                try {
                    const res = await fetch(`${BASE_URL}/api/review_tags/get_review_tags.php`);
                    const result = await res.json();

                    if (result.success && result.data?.length > 0) {
                        const activeTags = result.data.filter(tag => tag.is_active == 1);

                        if (activeTags.length === 0) {
                            container.innerHTML = '<div class="text-muted">Hiện chưa có tag nào để chọn.</div>';
                            return;
                        }

                        container.innerHTML = ''; // Xóa loading

                        activeTags.forEach(tag => {
                            const btn = document.createElement('div');
                            btn.className = 'tag-select';
                            btn.textContent = tag.content;
                            btn.dataset.tagId = tag.review_tag_id;

                            // Click để chọn/bỏ chọn – HOẠT ĐỘNG 100%
                            btn.addEventListener('click', function () {
                                this.classList.toggle('selected');
                            });

                            container.appendChild(btn);
                        });
                    } else {
                        container.innerHTML = '<div class="text-muted">Chưa có tag nào được bật.</div>';
                    }
                } catch (err) {
                    console.error('Lỗi tải tag:', err);
                    container.innerHTML = '<div class="text-danger">Lỗi tải tag đánh giá!</div>';
                }
            }

            // === 2. LẤY DANH SÁCH TAG ĐÃ CHỌN ===
            function getSelectedTagIds() {
                const selected = document.querySelectorAll('#reviewTagContainer .tag-select.selected');
                return Array.from(selected).map(el => el.dataset.tagId);
            }

            // === 3. GỌI HÀM TẢI TAG NGAY KHI TRANG LOAD ===
            loadReviewTags();

            // === 4. XỬ LÝ KHI NHẤN "GỬI ĐÁNH GIÁ" (test) ===
            // document.getElementById('submitReview')?.addEventListener('click', function () {
            //     const selectedTags = getSelectedTagIds();
            //     if (selectedTags.length > 0) {
            //         console.log('Tag đã chọn:', selectedTags);
            //         alert(`Bạn đã chọn ${selectedTags.length} tag! ID: ${selectedTags.join(', ')}`);
            //         // Sau này gửi kèm: formData.append('tag_ids', selectedTags.join(','));
            //     } else {
            //         alert('Bạn chưa chọn tag nào!');
            //     }
            // });

            let uploadedImageNames = []; // Đây là biến bạn đang thiếu!!!

            document.addEventListener('DOMContentLoaded', async () => {
                // === XỬ LÝ UPLOAD ẢNH + PREVIEW ===
                const reviewImagesInput = document.getElementById('reviewImages');
                const previewContainer = document.getElementById('previewImages');

                reviewImagesInput?.addEventListener('change', function (e) {
                    const files = e.target.files;
                    uploadedImageNames = []; // Reset mảng
                    previewContainer.innerHTML = ''; // Xóa preview cũ

                    if (files.length > 5) {
                        alert('Chỉ được upload tối đa 5 ảnh!');
                        this.value = '';
                        return;
                    }

                    Array.from(files).forEach((file, index) => {
                        if (!file.type.startsWith('image/')) {
                            alert('Chỉ chấp nhận file ảnh!');
                            return;
                        }

                        // Tạo tên file duy nhất (tránh trùng)
                        const fileName = `review_${Date.now()}_${index}_${file.name}`;
                        uploadedImageNames.push(fileName);

                        // Tạo preview
                        const reader = new FileReader();
                        reader.onload = function (ev) {
                            const imgWrapper = document.createElement('div');
                            imgWrapper.className = 'position-relative';

                            const img = document.createElement('img');
                            img.src = ev.target.result;
                            img.style.width = '100px';
                            img.style.height = '100px';
                            img.style.objectFit = 'cover';
                            img.style.borderRadius = '8px';
                            img.style.border = '2px solid #ddd';

                            // Nút xóa ảnh
                            const removeBtn = document.createElement('button');
                            removeBtn.innerHTML = '&times;';
                            removeBtn.style.position = 'absolute';
                            removeBtn.style.top = '5px';
                            removeBtn.style.right = '5px';
                            removeBtn.style.width = '24px';
                            removeBtn.style.height = '24px';
                            removeBtn.style.borderRadius = '50%';
                            removeBtn.style.background = 'rgba(0,0,0,0.6)';
                            removeBtn.style.color = 'white';
                            removeBtn.style.border = 'none';
                            removeBtn.style.cursor = 'pointer';
                            removeBtn.style.fontSize = '16px';

                            removeBtn.onclick = function () {
                                // Xóa khỏi mảng và preview
                                const idx = uploadedImageNames.indexOf(fileName);
                                if (idx > -1) uploadedImageNames.splice(idx, 1);
                                imgWrapper.remove();
                                // Cập nhật lại input file (khó, nên để người dùng chọn lại nếu cần)
                            };

                            imgWrapper.appendChild(img);
                            imgWrapper.appendChild(removeBtn);
                            previewContainer.appendChild(imgWrapper);
                        };
                        reader.readAsDataURL(file);
                    });
                });

                // === GỬI ĐÁNH GIÁ (BÂY GIỜ ĐÃ CÓ uploadedImageNames) ===
                document.getElementById('submitReview')?.addEventListener('click', async () => {
                    const tagIds = getSelectedTagIds();

                    // Lấy số sao
                    const stars = document.querySelectorAll('#ratingStars i');
                    let rating = 0;
                    stars.forEach((star, idx) => {
                        if (star.classList.contains('active')) rating = idx + 1;
                    });

                    const data = {
                        product_id: new URLSearchParams(window.location.search).get('id'),
                        customer_name: document.getElementById('reviewName').value.trim(),
                        phone: document.getElementById('reviewPhone').value.trim(),
                        rating: rating,
                        size: document.getElementById('reviewSize').value,
                        color: document.getElementById('reviewColor').value.trim(),
                        content: document.getElementById('reviewContent').value.trim(),
                        images: uploadedImageNames,  // ĐÃ CÓ RỒI, KHÔNG LỖI NỮA!
                        tag_ids: tagIds
                    };

                    // Validate
                    if (!data.customer_name || !data.phone || rating === 0 || !data.content) {
                        alert('Vui lòng điền đầy đủ thông tin bắt buộc!');
                        return;
                    }

                    try {
                        const res = await fetch(`${BASE_URL}/api/review_products/create_review.php`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });

                        const result = await res.json();
                        alert(result.message);

                        if (result.success) {
                            // Reset form
                            document.getElementById('writeReviewCollapse').classList.remove('show');
                            document.getElementById('reviewImages').value = '';
                            previewContainer.innerHTML = '';
                            uploadedImageNames = []; // Reset lại mảng
                            // Reload đánh giá nếu cần
                        }
                    } catch (err) {
                        console.error(err);
                        alert('Lỗi gửi đánh giá!');
                    }
                });

                // === CÁC HÀM KHÁC: load tag, sao, phân trang... ===
                loadReviewTags();
                setupRatingStars(); // bạn cần có hàm này nếu chưa
                // ... các hàm khác
            });

            // Hàm lấy tag đã chọn
            function getSelectedTagIds() {
                return Array.from(document.querySelectorAll('#reviewTagContainer .tag-select.selected'))
                            .map(el => el.dataset.tagId);
            }

            // Hàm chọn sao (nếu chưa có)
            function setupRatingStars() {
                const stars = document.querySelectorAll('#ratingStars i');
                stars.forEach((star, idx) => {
                    star.addEventListener('click', () => {
                        stars.forEach((s, i) => {
                            s.classList.toggle('active', i <= idx);
                            s.classList.remove('bx-star');
                            s.classList.add(i <= idx ? 'bxs-star' : 'bx-star');
                            s.style.color = i <= idx ? '#f39c12' : '#ccc';
                        });
                    });
                });
            }
        })
        const BASE_URL = '/MayMacCTH';

        document.addEventListener('DOMContentLoaded', async () => {
            const addressEl = document.getElementById('footerAddress');
            const websiteEl = document.getElementById('footerWebsite');
            const phoneEl = document.getElementById('footerPhone');

            if (!addressEl && !websiteEl && !phoneEl) return;

            try {
                const res = await fetch(`${BASE_URL}/api/contact/get_contact.php?t=${Date.now()}`);
                const data = await res.json();

                if (data.success && data.data && data.data.length > 0) {
                    const c = data.data[0];

                    if (addressEl) {
                        addressEl.textContent = c.address || 'Chưa cập nhật địa chỉ';
                    }

                    if (websiteEl) {
                        if (c.website && c.website.trim()) {
                            const url = c.website.match(/^https?:\/\//i) ? c.website : 'https://' + c.website;
                            websiteEl.outerHTML = `<a href="${url}" target="_blank" class="text-white text-decoration-none">${c.website}</a>`;
                        } else {
                            websiteEl.textContent = 'Chưa có website';
                        }
                    }

                    if (phoneEl) {
                        phoneEl.textContent = c.phone_number || 'Chưa cập nhật số điện thoại';
                    }
                }
            } catch (err) {
                console.error('Lỗi load footer contact:', err);
            }
        });

        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartCountEl = document.querySelector('#cartCount');
            if (cartCountEl) {
                cartCountEl.textContent = totalItems;
                cartCountEl.style.display = totalItems > 0 ? 'block' : 'none';
            }
        }

        // Gọi khi trang load xong
        updateCartCount();
    </script>
</body>

</html>